<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.8.13"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>Cells Documentation: Networking</title>
        <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
        <script type="text/javascript" src="dynsections.js"></script>
        <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
        <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
        <link href="jquery.smartmenus.bootstrap.css" rel="stylesheet">
        <script type="text/javascript" src="jquery.smartmenus.js"></script>
        <!-- SmartMenus jQuery Bootstrap Addon -->
        <script type="text/javascript" src="jquery.smartmenus.bootstrap.js"></script>
        <!-- SmartMenus jQuery plugin -->
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand">Cells Documentation </a>
                </div>
            </div>
        </nav>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="page_sw_architecture.html">SW Architecture</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Networking </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Networking </h1>
<h2>The Photon Framework </h2>
<p>We use the Photon PUN library and service for our multiplayer. Benefits are an abstraction of the lower-level networking stuff and server-based connections, i.e. no Peer-To-Peer and NAT problems.</p>
<p>Photon offers different means of network communication and I'll introduce them here:</p>
<h3>PhotonView</h3>
<p>This components can be added to GOs to enable instance-based syncing as follows:</p>
<ul>
<li>The object can be spawned and deleted on all clients in sync and Photon maintains the logical connection between each copy on the clients.</li>
<li>Remote-Procedure-Calls (RPCs) can be called for scripts on that object. These allow a function to be called from one client (mostly the owner/creator of the GO) to be activated on all clients.</li>
<li>Synchronization of data from other components. Photon offers pre-made syncing scripts, for example for the transform, which thus syncs movement. Custom components have to implement a certain Interface to receive callbacks to read and write data to sync.</li>
</ul>
<h3>PhotonEvents</h3>
<p>Photon also features an event system, where each event has a unique ID and can transport data in the shape of an array of <em>object</em>-type objects. To make this easier we have a custom extension for this, called <a class="el" href="classnet_1_1_net_event.html" title="This is a convenience wrapper for Photons networked event system. ">net::NetEvent</a>, which is explained below.</p>
<h3>Client Properties</h3>
<p>This mechanism saves data under a hashed string as identifier for one client. All clients can access the data of other clients, making this a good tool to sync client-specific data (e.g. a 'Readiness' flag) across all clients. The client data is kept even through disconnects and room changes, I think. For BomberUnits, this was used to save information on the local players for each client, including their chosen color, model, etc...</p>
<h4>Room Properties</h4>
<p>Client assemble within one room to be able to play a game together. This room can also maintain synced data, akin to the client properties. This could for example be used to share common settings for the game, such as the selected level.</p>
<h2>What needs to be synced? </h2>
<p>I think there are three important categories of what needs to be synced:</p><ul>
<li>Game Logic: Everything related to the state of the game of course needs to be in sync. This encompasses general things, like readiness indication in matchmaking an common scene transitions, as well as important events, such as the demise of unit.</li>
<li>Fairness-related HMI:</li>
<li>Nice-to-have HMI things: Everything that is not needed according to the above categories, but gives the players more information, such as having health bars for units.</li>
</ul>
<p>The means to do the syncing should be made as easy and clear as possible, as the networking stuff can become quite tangled quickly anyway. It has to be decided on a case-by-case basis how this is to be done.</p>
<p>All synced elements and the concepts used are explained on a subpage: <a class="el" href="page_synced_elements.html">Synced Elements</a></p>
<h2>The NET Management layer </h2>
<p>In addition to the above mechanism, communication with the Photon API and the current network is needed For this the <a class="el" href="classnet_1_1_net_manager.html" title="Manages all Network related topics, is persistent across scenes, just as the game manager...">net::NetManager</a> singleton instance manager receives callbacks, which are then raised as events for all relevant users to pick up.</p>
<p>The <a class="el" href="classnet_1_1_net_adapter.html">net::NetAdapter</a> static class offers our own interface to the Photon static API functions. It provides, for example, functions to create and destroy objects networked, i.e. in sync on all clients.</p>
<p>Finally, the <a class="el" href="classnet_1_1_net_state_machine.html">net::NetStateMachine</a> implements the different states the connection can be in as an Animator- based SM. Most states subscribe to events from the <a class="el" href="classnet_1_1_net_manager.html" title="Manages all Network related topics, is persistent across scenes, just as the game manager...">net::NetManager</a> to decide how the SM transitions.</p>
<h2>Custom expansions on the provided networking API </h2>
<p>The <a class="el" href="classnet_1_1_net_event.html" title="This is a convenience wrapper for Photons networked event system. ">net::NetEvent</a> class is designed to work like a UnityEvent, while offering the capability to invoke them networked on all clients. Each created instance automatically registers itself with a unique ID to the Photon event system. Each event can carry data types which implement the net::INetDataPkg interface. Implementing this interface means casting all data held within the type to <em>object</em> and back, so it can be handled uniformly within the NetEvent. </p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>
Generated on Sun Nov 1 2020 11:31:49 for Cells Documentation by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
        <script type="text/javascript" src="doxy-boot.js"></script>
</html>
